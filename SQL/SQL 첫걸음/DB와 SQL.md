# 1장. 데이터베이스와 SQL



## 1강 데이터베이스

> 데이터란 컴퓨터 안에 기록되어 있는 숫자를 의미하며, 이러한 **데이터의 집합을 *데이터베이스*** 라고 합니다. 넓은 의미에서는 '컴퓨터 안에 기록된 모든 것'이지만 일반적으로는 '**간단하게 찾아낼 수 있도록 정리된 형태**'를 말합니다. 그리고 데이터베이스는 비휘발성 저장장치(하드디스크, SSD)에 저장합니다.



### 1.1 시스템 내의 데이터베이스

> 데이터베이스는 일반적으로 데이터 센터의 서버에서 운용했으나, 현재는 개인용 PC나, 휴대용 기기에 내장되어 있기도 합니다. 인터넷 쇼핑을 하거나 무너가 예약할 때는 웹 시스템을 통해 데이터 베이스에 접근할 수 있습니다. 예를 들면, 쇼핑 사이트에서 주문을 하면 데이터베이스에 고객정보나 주문정보 등이 저장됩니다. 물론 시스템을 직접 사용하지 않는 상황에서도 데이터베이스에 데이터가 전송되는 경우도 있습니다. 편의점에서 물건을 사고 POS(계산대)에서 데이터가 데이터베이스로 전송됩니다. 그리고 휴대전화의 전화번호부 역시 데이터 베이스의 좋은 예입니다.



### 1.2 DB와 DBMS

> **DB는 데이터베이스의 약자**입니다. 그리고 **데이터베이스를 효율적으로 관리하는 소프트웨어를 DBMS(Database Management System)**이라고 합니다.

##### DBMS가 필요한 이유

- 생산성
  - 시스템 개발 과정에서의 생산성 향상을 도모할 수 있습니다. 어떤 시스템이든 **검색, 추가, 삭제, 갱신**과 같은 처리가 이루어집니다. 이와 같은 **기본 기능을 DBMS가 제공**하기에 시스템 구축할 때 기본 기능부터 구현하는 것은 비용 측면에서 비효율입니다.
- 기능성
  - DBMS는 데이터베이스를 다루는 기능을 많이 제공합니다. 복수 유저의 요청에 대응하거나, 대용량 데이터를 저장하고 빠르게 검색하는 기능을 제공하기도 합니다. 나아가 DB관리 기능을 유저가 확장할 수도 있어 유연하게 시스템을 개발 가능합니다.
- 신뢰성
  - 대규모 DB는 많은 요청에 대응할 수 있도록 만들어져 있습니다. 이를 위해 여러 하드웨어를 구성하여 신뢰성을 높이는 동시에 성능 향상을 꾀하기도 합니다. DBMS는 여러 컴퓨터에서 소프트웨어를 통해 **확장성과 부하 분산**을 구현합니다. 이를 보통 **'클러스터 구성'** 또는 **'스케일 아웃'**이라 부릅니다.
  - 많은 DBMS가 DB의 데이터를 다른 저장장치로 내보내거나(Exprot), 반대로 DB안에 집어넣는(Import) 등의 기능을 갖췄습니다. 이 기능을 통해 DB를 간단하게 백업할 수 있습니다.



### 1.3 DB를 조작하는 언어 SQL

> **DBMS와의 대화에 필요한 것이 바로 SQL**입니다. DB에도 여러 종류가 있는데,  SQL은 그 중 **'RDBMS(관계형 DBMS)'** 를 조작할 때 사용합니다.

##### SQL 명렁의 종류

- DML
  - Data Manipulation Language의 약자. DB에 새롭게 **데이터를 추가하거나 삭제하거나 내용을 갱신하는 등, 데이터를 조작할 때 사용**합니다. SQL의 가장 기본이 되는 명령 set입니다.
- DDL
  - Data Definition Language의 약자로 데이터를 정의하는 명령어. **DB는 'DB 객체' 라는 데이터 그릇을 이용하여 데이터를 관리하는데, 이같은 객체를 만들거나 삭제하는 명령어**입니다.
- DCL
  - Data Control Language의 약자로 데이터를 제어하는 명령어. DCL에는 **트랜잭션을 제어하는 명령과 접근권한을 제어하는 명령이 포함**되어 있습니다.



## 2강 다양한 데이터베이스

> DBMS에는 여러 종류가 있습니다. DB의 사용 용도나 이를 제어하는 프로그래밍 환경 등 각각의 조건에 들어맞는 다양한 DBMS가 고안되었기 때문이다. DB중에서도 SQL로 데이터를 다루는 데이터베이스를 관계형 데이터베이스라고 합니다. 관계형 DB는 많은 시스템에 채택된 주류이며, 제품도 여러가지가 있습니다.



### 2.1 데이터베이스 종류

> DBMS는 **데이터 저장 방법에 따라 몇 가지로 분류**할 수 있습니다. 이제 오래된 순서로 DBMS를 소개합니다.

- 계층형 데이터베이스
  - **폴더와 파일 등의 계층 구조로 데이터를 저장하는 방식의 DB**입니다. 하드디스크나 DVD 파일시스템이 이러한 계층형 DB라고 할 수 있습니다. 그러나 현재 DBMS로서 채택되는 경우는 많지 않습니다.
- 관계형 데이터베이스
  - 관계 대수(relational algevra) 라는 것에 착안하여 고안한 DB입니다. 관계 대수란 말은 **행과 열을 가지는 표 형식 데이터를 저장하는 형태의 DB**를 가리킵니다. 물론, *엄밀히 말하면 표 형식 데이터와는 관계가 없습니다*. 유사한 이미지로 엑셀 시트를 떠올릴 수 있겠습니다. 관계형 DB에는 이러한 표를 잔뜩 저장해두고, 각각의 표에 이름을 붙여 관리합니다. 이때 **DB 안의 데이터를 SQL 명령어로 조작**할 수 있습니다.
  - **이후 소개할 DB라는 용어는 모두 RDBMS를 일컫는 것입니다.**
- 객체지향 데이터베이스
  - 객체지향 언어는 '객체'라는 것을 중심으로 프로그래밍하는 언어입니다. 여기서 가능하면 **객체 그대로를 DB의 데이터로 저장하는 것이 객체지향 DB**입니다. 
- XML 데이터베이스
  - XML이란 자료 형식을 가리키는 용어로, 태그를 이용해 마크업 문서를 작정할 수 있게 정의한 것입니다. 태그는 \<data>데이터\</data> 와 같은 형식으로 표현합니다. XML DB는 이처럼 XML형식으로 기록된 데이터를 저장하는 DB입니다. **XML DB에서는 SQL 명령어를 사용할 수 없고 XQuery라는 전용 명령어를 사용합니다.**
- Key / Value 스토어
  - Key와 그에 대응하는 Value 라는 단순한 형태의 데이터를 저장하는 DB입니다. Key/Value 조합은 연상배열(Dictionary라고 부르기도함)이나 해시 테이블(Hash table)에서 자주 볼 수 있습니다. NoSQL(Not only SQL)이라는 슬로건으로부터 생겨난 DB로, column orient DB라고도 불립니다.



### 2.2 RDBMS 사용 시스템

> RDBMS는 다양한 시스템에서 사용됩니다. 메인프레임은 대부분 RDBMS를 사용한다 해도 과언이 아닙니다. 다만 최근들어 메인프레임 자체를 찾아보기 어려워졌습니다. 다운사이징으로 인해 소형 워크스테이션으로 대체된 것입니다. 그래도 여전이 DB서버로는 RDBMS가 사용되었는데, 이때부터 클라이언트 / 서버 구조도 유행하기 시작했습니다. 일반적으로 사용하는 인프라는 당연히 인터넷입니다. 웹 시스템과 연동하여 RDBMS를 사용하는 경우도 많아졌습니다. 비행기 예약부터 작은 병원 예약까지 RDBMS는 널리 쓰입니다.
>
> 하드웨어 진화 역시 한몫합니다. 단말이 고성능화, 소형화되면서 휴대전화에도 RDBMS가 내장되어 있습니다. 예를들어 핸드폰 OS 안드로이드에는 SQLite라는 RDBMS가 표준이로 기본 내장되어 있습니다.



### 2.3 데이터베이스 제품

> RDBMS는 관계형 DB를 관리하는 소프트웨어를 일컫는 말입니다. 그러나 RDBMS라는 이름의 소프트웨어가 존재한다는 뜻은 아닙니다. 시중에 판매되거나 오픈소스로 자유롭게 다운르도 할 수 있는 유명한 제품에는 다음과 같은 것들이 있고 모두 SQL을 사용가능 합니다.

- Oracle
  - 오라클에서 개발한 현재 가장 많이 쓰이는 RDBMS 중 하나로 사실상 표준이라고 해도 문제 없을 정도로 유명합니다. 유닉스 워크스테이션 중심입니다.
- DB2
  - IBM이 개발하였고 한동안 IBM 컴퓨터에서만 구동되었습니다. 이후 유닉스나 윈도우 등의 플랫폼에서도 구동 가능하게 되었으나, 시장 점유율을 확대할 수는 없었습니다.
- SQL Server
  - MS가 개발한 것으로, 윈도우 플랫폼에서만 동작합니다. 비교적 새로운 제품으로 윈도우가 서버 분야로 영역을 넓히면서 SQL Server를 사용하는 시스템도 많이 증가하였습니다.
- PostgreSQL
  - 오픈소스 커뮤니티가 개발한 RDBMS이며, 무료 소프트웨어입니다. 실험적인 기능이 포함되거나 독특한 구조를 가지기도 합니다.
- MySQL
  - 오픈소스 커뮤니티에서 개발되었고 출시 당시 경량 DB라는 점을 강조하다 보니 필요한 최소한의 기능만을 갖추었습니다. 그러나 기능이 확장되면서 지금은 다른 RDBMS와 비교해도 부족하지 않습니다. 이후 MySQL을 사용하여 하급하는 것을 전제로 MySQL용 예제 데이터를 준비했습니다.
- SQLite
  - 오픈소스 커뮤니티에서 개발된 인베디드 시스템에 자주 쓰이는 작은 RDBMS입닌다.



### 2.4 SQL의 방언과 표준화

> RDBMS는 처음부터 SQL 명령어를 이용해 DB를 조작하도록 설계된만큼 SQL을 사용할 수 없는 RDBMS는 없습니다. 그러나 각 DB별로 기능 확장이 이루어지는 과정에서 '비슷한 조작을 실행하더라도 서로 다른 명령어가 필요한 상황'이 발생했습니다. 즉 특정 DB 제품에만 통용하는 고유 방언이 생겨난 것입니다.
>
> 방언의 예로 키워드 생략을 들 수 있습니다. 데이터를 삭제할 때는 DELETE 명령어를 사용하는데, Oracle이나 SQL Server에서는 DELETE 뒤에 붙는 FROM을 생략해도 별 다른 문제가 없습니다. 그에비해 DB2나 PostgreSQL, MySQL에서는 FROM을 생략할 경우 구문 에러가 발생해 실행되지 않습니다.
>
> 프로그래밍 언어의 세계에서 '방언'은 환영받지 못합니다. 이 같은 방언을 없애려면 모두 '표준어'를 사용하면 되겠지요. ISO나 ANSI가 결정한 'SQL-92', 'SQL-99', 'SQL-2003' 등이 바로 표준 SQL입니다. 여기서 숫자는 책정된 해를 나타냅니다.
>
> 지금까지 많은 RDBMS가 표준화에 동참하여 기능을 확장해온 덕택에 형재는 방언이 많이 줄어들었습니다. 이후에도 표준 SQL을 기준으로 설명합니다. 



## 3강 데이터베이스 서버

> 많은 RDBMS가 클라이언트 / 서버 모델을 채택해 가동 중입니다. 특히 웹 시스템과 연동하는 RDBMS라면, 접속자 수가 수백 명에 달하는 전용 DB 서버를 운용하는 일도 드물지 않습니다. 이제 DB를 네트워크로 연결된 서버라는 관점에서 바라보며 진행하겠습니다.
>
> **RDBMS는 복수의 클라이언트가 보내오는 요청에 응답할 수 있도록 클라이언트 / 서버 모델로 동작합니다.** 클라이언트는 서버에 접속 요청이나 SQL 명령 실행요청을 보낼 수 있습니다. 서버는 이를 처리하고 클라이언트에 그 결과를 반환합니다. 일반적인 RDBMS는 네트워크 상에 하나의 서버를 두고 독점해 사용합니다. 하지만 고가의 서버를 준비하기 여려운 경우, 자신의 PC에 클라이언트와 서버 모두를 실행시켜 운용할 수 있습니다.



### 3.1 클라이언트 / 서버 모델

> 클라이언트/서버 모델이란 **사용자 조작에 따라 요청을 전달하는 '클라이언트'**와 **해당 요청을 받아 처리하는 '서버'**로 소프트웨어를 나누고, 복수의 컴퓨터 상에서 하나의 모델을 구현하는 시스템을 말합니다.

- 웹 시스템에서의 클라이언트/서버
  - 웹 시스템이란 브라우저와 웹 서버로 구성되는 클라이언트/서버 모델의 시스템을 말합니다. 
  - 웹 시스템에서 클라이언트 기능을 하는 브라우저는 사용자가 지정한 URL과 연결된 웹 서버에 요청을 보냅니다. 요청 상황은 대부분 '페이지를 열람하고 싶다' 일 것입니다. 이때 **클라이언트가 보내는 요구사항을 리퀘스트**(이하 요청) 라고 합니다.
  - 클라이언트의 요청을 받은 웹 서버에서는 그에 맞게 처리합니다. 데이터는 네트워크를 통해 전송됩니다. **서버의 응답은 리스폰스**(이하 응답)라고 합니다. 이것으로 전형적인 클라이언트/서버 모델에서의 처리가 하나 종료되었습니다. 실제 **웹에서는 요청과 응답이 되풀이되면서 웹 페이지가 표시됩니다.**
-  RDBMS의 클라이언트/서버
  - RDBMS도 웹 시스템과 마찬가지로 클라이언트/서버 모델로 시스템이 구성되지만, **단순히 요청과 응답을 되풀이하는 것은 아닙니다**. 웹 시스템에는 없었던 **사용자 인증**이 필요하며, 사용자 별로 DB 접근을 제한할 수 있습니다. 사용자 인증은 사용자 ID와 비밀번호로 실행되고 인증에 실패하면 DB에 접속할 수 없습니다.
- SQL 명령 실행
  - RDBMS에 접속하면 SQL 명령을 서버에 보낼 수 있습니다. 서버가 가동 중이고 네트워크에 연결되어 있다면, 클라이언트에서 SQL 명령을 보낼 때 서버는 응답할 것입니다. 일단 한번 DB에 접속하면, 이를 유지하여 재접속 없이 SQL 명령을 여러번 보낼 수 있습니다. 사용이 끝나면 DB와의 접속은 끊깁니다. 또한 일반적으로 클라이언트를 종료하여도 DB와의 접속이 끊깁니다.



### 3.2 웹 애플리케이션의 구조

> 웹 애플리케이션은 일반적으로 웹 서버와 DB 서버의 조합으로 구축됩니다. 웹 시스템은 클라이언트/서버 모델로 구성되며 브라우저가 클라이언트, Apache나 IIS와 같은 웹 소프트웨어가 서버 역할을 합니다. 클라이언트가 서버에게 요청하면 웹 서버는 클라이언트에게 응답합니다. 웹사이트가 정적인 HTML만으로 구성되어 있다면 웹 서버만으로 시스템을 구축할 수 있을 것이지만, **웹 애플리케이션이라 부를 정도의 규모라면 DB가 필요**합니다.
>
> 웹 서버에서 동적으로 HTML을 생성하려면 제어용 프로그램이 필요합니다. 웹 서버에는 CGI라 불리는 동적 콘텐츠를 위한 확장 방식이 있습니다. 이 CGI를 이용하여 프로그램과 웹 서버간을 연동, 통신하여 처리합니다.
>
> 프로그래밍 언어로서는 펄(Per)이나 PHP, 루비(Ruby) 등의 스크립트 언어가 자주 사용됩니다. 윈도우의 경우는 ASP.NET이 많이 사용되며, 자바와 Servlet과 같은 조합도 있습니다.
>
> **실제로 DB에 접속하는 것은 PHP나 루비 등의 프로그래밍 언어로 만들어진 CGI 프로그램**입니다. DB 서버를 사용하기 위해서는 DB 서버와의 접속이 성립되어야 합니다. 그 후 DB에 필요한 SQL 명령을 전달하고, 실행 결과는 클라이언트로 되돌아갑니다. 이때 **웹 서버의 CGI 프로그램이 DB의 클라이언트**가 됩니다. **클라이언트 브라우저가  웹서버에 요청과 응답을 받고 웹 서버에서 CGI 프로그램이 클라이언트가 되어 DB에 접속하는 형식**입니다. 클라이언트와 서버가 네트워크로 연결되어 있다면 다른 머신에 두어도 무방합니다. **웹 서버와 DB서버를 서로 다른 머신에 두면 처리가 분산되어 시스템 전체 성능이 향상**됩니다.



### 3.3 MySQL 서버와 mysql 클라이언트

> MySQL 패키지를 PC에 인스톨하면 서버와 클라이언트 모두 사용할 수 있습니다. MySQL 서비스가 DB 서버가 되고 mysql 커맨드가 클라이언트가 됩니다. MySQL 서비스는 PC 기동과 함께 자동으로 실행됩니다. MySQL 서버에 접속해 SQL 명령을 실행하는 방법은 여러 가지가 있지만, 이후 표준 커맨드인 mysql 클라이언트를 이용하는 것을 전제로 합니다.
>
> 지금까지 설명한 것처럼 클라이언트/서버 모델은 시스템의 하드웨어 구성을 유연하게 변경할 수 있도록 해줍니다. 클라이언트가 많아져 서버의 능력이 부족해지면 추가로 설치하여 부하 분산해 시스템 전체의 성능을 높일 수 있습니다.
>
> PC 한 대로 클라이언트와 서버 모두 실행할 수 있지만 네트워크 기능은 필요합니다. 클라이언트에서 서버에 접속할 필요가 있는데, 이때 **네트워크를 경유해서 PC의 서버로 되돌아오는 형태로 접속**합니다. 이를 **'루프백 접속'**이라고 부릅니다.

