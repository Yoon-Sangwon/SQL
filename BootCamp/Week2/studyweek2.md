## 개념적 데이터 모델링

> 일을 하는 순서와 배우는 순서는 다를 수 있다. 논리적 모델링보다 앞선 단계가 개념적 모델링이지만, 논리적 모델링을 모르고 개념적 모델링을 배운다면 힘듦. 모델링이란 업무라는 현실과 DB라는 현실을 이사시키는 것. 두가지를 모르고 개념을 이해하기란 힘들 것.
>
> Entity Relationship Diagram은 두 가지의 효용을 줄 수 있음
>
> - 필터 : 현실에서 개념을 추출하는 일종의 필터로서 작용
> - 언어 : 개념에 대해서 다른사람들과 대화 해주는 언어로서 작용

현실은 복잡함. 이런 현실에서 개념을 뽑아내는 일은 어려움

세상을 간단하게 볼 수 있는 파인더가 있다면 편함. 이때 ERD가 3개의 관점으로 세상을 볼 수 있게 하는 파인더 역할임.

1. 정보 : 정보를 발견하고 다른사람에게 표현할 수 있게 해줌
2. 그룹 : 연관된 정보를 그룹핑하고 표현할 수 있게 해줌
3. 관계 : 정보 그룹 사이에 관계를 표현할 수 있게 해줌

현실로부터 개념을 인식하는 도구이면서 다른사람들도 알아볼 수 있게 해주는 것이 ERD임

매우 쉽게 표로 전환이 가능하다는 장점이 있음. 



### ERD를 만드는 방법

기획서에는 여러가지 정보가 흩어져 있음

- 저자 댓글의 내용

서로 연관된 내용을 가진 덩어리를 묶어주어야함

- 글, 저자, 댓글, 댓글의 저자

이를 표현할 그림은? 정답은 없음. 타당하기만 됨

![](.\ERD.png)

RDB에서는 아래 모델이 더 적절함

WHY? RDB에서는 내포관계(표 안의 표)는 허용하지 않음

대신 하나의 표에 표현하는 것이 더 적절함

단점으로는 데이터가 조금만 많아져도 행이 어마어마하게 많아짐

따라서 하나가 필요하더라도 몇 천개의 데이터를 불러들여야할 수도 있다.

또한 중복되는 데이터 역시 엄청난 수가 있을 것 -> 실수할 확률이 높아짐

이는 여러개의 표로 나누면서 해결이 가능해진다.

![](.\ERD2.png)

표를 나눈 것의 장점

주제에 따라 데이터를 그룹핑할 수 있다. 중요

글에 대한 정보만 필요하면 글 테이블만 가져옴으로써 PC의 자원을 아낄 수 있다.

Join이 가능함! 필요할 때마다 합성이 가능(굉장히 중요)



위에서 찾아낸 개념들(댓글, 글, 저자)을 개념적 모델링(ERD)에서는 Entitiy라고 부른다.

이는 Table로 전환이 될 것.

글이라는 Entitiy는 실제 데이터가 아님. 구체적인 데이터는 제목, 생성일, 본문임

이를 그룹핑한 것이 글. 구체적인 데이터는 Attribute(속성)이라고 하고 이는 후에 표의 column이 됨

Entity는 파일만 담을 수 있고 다른 Directory를 담을 수 없는 Directory라고 생각할 것

Attribute는 파일이라고 생각할 것



글과 저자, 댓글은 서로 복잡한 관계를 이루고 있음

이는 Relation 후에 논리적 데이터 모델링에 가게되면 기본키(PK, FK)라고 표현됨

이것은 Join으로 연결함

<img src=".\Relation.png" style="zoom:50%;" />



개념적 데이터 모델링은 개념에 집중하고 데이터베이스 페러다임으로부터 거리를 두고 있음

용어가 실제 DB 제품과는 다름.

Entity -> Table

Attribute -> Column

Relation -> PK, FK

Tuple -> Row

 

Application이 건물로 비유하면, 옥상은 User Interface 지하는 Database라고 할 수 있음.

UI가 원인이 되어서 DB를 변경하는 결과를 낳음

데이터라는 원인이 UI라는 결과를 낳음

즉 서로 원인과 결과의 관계에 있다고 할 수 있음

따라서 기획자와 구현자가 다르다면 데이터 모델링까지는 동행 하는 것이 이상적

서로 놓치면 안되는 틈



제일 먼저 해야할 일은 Entity를 찾아야함

사람은 연관된 것들은 그룹핑하는 능력을 가지고 있음

쓰기 화면에서 알 수 있음

<img src=".\ERD3.png" style="zoom:30%;" />



속성 정의

<img src=".\Atti.png" style="zoom:45%;" />



Identifier : 식별자(대표선수)를 찾아서 지정

식별자 : 원하는 대상을 정확하게 타겟팅

식별자가 되기 위한 가장 중요한 것 : 그 누구도 같은 값을 가지고 있으면 안됨

식별자는 Primary Key가 될 것임

| user_id | email      | national_id | name   | city  |
| ------- | ---------- | ----------- | ------ | ----- |
| 1       | a@mail.com | 100001      | egoing | seoul |
| 2       | b@mail.com | 100002      | leeche | jeju  |
| 3       | c@mail.com | 100003      | egoing | jeju  |

위의 표에서 Name과 City는 중복이 될 수 있으므로 식별자가 될 수 없음

email은 살짝 애매함. 특정 조직 이메일은 중복될 수 있음

user_id 는 '인조키' 라고 부름

candidate key : user_id, email, national_id

만약 user_id를 기본키로 설정했다면 user_id를 primary key

email과 national_id는 alternate key라고 한다.

alternate key 는 성능향상을 위해 secondary index를 걸기에 아주 좋음



특수 케이스로 중복 키라는 것이 있음

| emp_no | dept_no | from_date |
| ------ | ------- | --------- |
| 1      | 1       | 2010      |
| 2      | 1       | 2011      |
| 1      | 2       | 2013      |

위와 같은 경우 emp_no와 dept_no 만으로는 구분할 수가 없음

따라서 emp_no와 dept_no를 중복키(Composite key)로 지정함



<img src=".\Atti.png" style="zoom:45%;" />

다음 상황에서는 key를 설정할만한 것이 없으므로 인조키인 글 ID를 만들어줌

 

Relationship

relationship은 무엇이 되는가?

![](.\Relation2.png)

각 표들은 데이터로서 연결되어 있다. 이때 행을 식별하는 유일무의한 식별자를 PK라고 함.

저자아이디는 외래에 있는 테이블과 연결할 때 필요한 것으로 외래키(Foreign Key)라고 한다

관계형 DB에서의 Relationship은 PK와 FK가 연결되는 것을 통해 실제로 구현됨 



이 관계를 그림으로 어떻게 표현하는가?

<img src=".\ERD 그림.png" style="zoom:60%;" />

Relationship에서 꼭 따져봐야하는 요소

Cardinality (like no)

<img src=".\11관계.png" style="zoom:30%;" />

위는 1:1 관계이다. 이를 ERD에서는 우측과 같이 표현한다.

<img src=".\1many.png" style="zoom:40%;" />

그리고 1대다, 다대다는 위와 같이 표현한다.

그러나 현실 DB에서는 다대다의 관계를 Table로 표현하기 어렵기 때문에 연결 Table을 만들어서 최종적으로 일대다 관계로 만들어준다

Optionality

<img src=".\ERD4.png" style="zoom:30%;" />

 위 그림에서 저자에게 댓글은 옵션이다. 이때 ERD(다이어그램)에서 O의 위치를 잘 기억할 것. 반대로 댓글에게 저자는 필수(Mandatory)다. 이때 ERD에서 |로 표시한다.

이제 둘을 합쳐서 ERD를 완성해보자.

<img src=".\ERD완성.png" style="zoom: 50%;" />





